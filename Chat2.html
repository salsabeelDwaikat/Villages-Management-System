<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Admins</title>
    <style>
        body {
            background-color:#1b1b2b;
            color: #fff;
            font-family: Arial, sans-serif;
        }

        header {
            padding: 3px;
            text-align: left;
        }

        .search-bar {
            padding: 3px;
            text-align: left;
            margin-bottom: 3px; 
        }

        .search-bar input {
            padding: 10px;
            border-radius: 10px;
            width: 600px;
            border: none;
            background-color: #fff;
            color:darkgray;
        }

        .available-admins {
            padding: 10px; 
            text-align: left;
            margin-top: 10px; 
            background-color:#2c2c3d;
        }

        .admin {
            display: inline-block;
            margin: 10px;
            text-align: left;
            cursor: pointer;
        }

        .admin img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
        }

        .admin p {
            margin-top: 5px;
        }

        .chat-section {
            padding: 10px;
            display: none; 
        }

        .chat-messages {
            height: 100px;
            overflow-y: scroll;
            background-color:#2c2c3d;
        }

        .message {
            margin: 5px;
            padding: 5px;
            border-radius: 5px;
        }

        .user-message {
            background-color:#333;
            text-align: left;
        }

        .admin-message {
            background-color: #333;
            text-align: left;
        }

        .message-input {
            display: flex;
            flex-direction: column; 
            margin-top: 20px;
            justify-content: flex-end; 
        }

        .message-input input {
            flex: 1;
            padding: 30px;
            border-radius: 5px;
            border: none;
            background-color: #fff;
            border-radius: 5px;
            color:darkgray ;
        }

        .message-input button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            align-self: center; 
        }

        .chat-section.active {
            display: block; 
            .chat-messages .admin-message {
                background-color: #1b1b2b; 
                color: #fff;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Chat with Admins</h1>
    </header>

    <section class="search-bar">
        <input type="text" id="searchInput" placeholder="Search for an admin.....">
    </section>

    <section class="available-admins">
        <h2>Available Admins</h2>
        <div class="admin-list" id="adminList"></div>
    </section>

    <section class="chat-section" id="chatSection">
        <h2>Chat with: <span id="adminName"></span></h2>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="message-input">
            <input type="text" id="messageInput" placeholder="Type your message.....">
            <button id="sendMessageButton">Send</button>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const adminList = document.getElementById('adminList');
            const searchInput = document.getElementById('searchInput');
            const sendMessageButton = document.getElementById('sendMessageButton');
            const messageInput = document.getElementById('messageInput');
            const chatMessages = document.getElementById('chatMessages');
            const adminNameElement = document.getElementById('adminName');
            const chatSection = document.getElementById('chatSection');

            
            const admins = [
                { name: 'Admin 1', image: 'admin1.jpg' },
                { name: 'Admin 2', image: 'admin2.jpg' },
                { name: 'Admin 3', image: 'admin3.jpg' }
            ];

           
            function displayAdmins(admins) {
                adminList.innerHTML = '';
                admins.forEach(admin => {
                    const adminDiv = document.createElement('div');
                    adminDiv.classList.add('admin');
                    adminDiv.innerHTML = `
                        <img src="${admin.image}" alt="${admin.name}">
                        <p>${admin.name}</p>
                    `;
                    adminList.appendChild(adminDiv);
                });
            }

           
            searchInput.addEventListener('input', function() {
                const searchValue = searchInput.value.toLowerCase();
                const filteredAdmins = admins.filter(admin => admin.name.toLowerCase().includes(searchValue));
                displayAdmins(filteredAdmins);
            });

            
            adminList.addEventListener('click', function(event) {
                const adminDiv = event.target.closest('.admin');
                
                if (adminDiv) {
                    const adminName = adminDiv.querySelector('p').textContent;
                    adminNameElement.textContent = adminName;
                    chatMessages.innerHTML = ''; 
            
                    
                    const welcomeMessage = document.createElement('div');
                    welcomeMessage.classList.add('message', 'admin-message');
                    welcomeMessage.innerHTML = `<p>${adminName}: Hello! How can I assist you today?</p>`;
                    chatMessages.appendChild(welcomeMessage);
            
                   
                    chatSection.classList.add('active');
            
                   
                    const socket = new WebSocket('ws://localhost:8080');
                    
                    socket.onopen = function() {
                        socket.send(`connect:${adminName}`);
                    };
            
                    socket.onmessage = function(event) {
                        const message = event.data;
                        const adminMessage = document.createElement('div');
                        adminMessage.classList.add('message', 'admin-message');
                        adminMessage.innerHTML = `<p>${adminName}: ${message}</p>`;
                        chatMessages.appendChild(adminMessage);
                    };
            
                    sendMessageButton.addEventListener('click', function() {
                        const userMessage = messageInput.value;
                        if (userMessage.trim()) {
                            const message = document.createElement('div');
                            message.classList.add('message', 'user-message');
                            message.innerHTML = `<p>You: ${userMessage}</p>`;
                            chatMessages.appendChild(message);
            
                            
                            socket.send(userMessage);
                            messageInput.value = ''; 
                        }
                    });
                }
            });

            displayAdmins(admins);
        });
    </script>
</body>
</html>